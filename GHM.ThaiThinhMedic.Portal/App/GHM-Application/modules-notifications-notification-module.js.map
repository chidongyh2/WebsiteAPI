{"version":3,"sources":["webpack:///./src/app/modules/notifications/notification-routing.module.ts","webpack:///./src/app/modules/notifications/notification.component.html","webpack:///./src/app/modules/notifications/notification.component.ts","webpack:///./src/app/modules/notifications/notification.module.ts","webpack:///./src/app/modules/notifications/notification.service.ts"],"names":[],"mappings":"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","file":"modules-notifications-notification-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { NotificationComponent } from './notification.component';\r\nimport { NotificationService } from './notification.service';\r\nimport { LayoutComponent } from '../../shareds/layouts/layout.component';\r\nimport { AuthGuardService } from '../../shareds/services/auth-guard.service';\r\n\r\nexport const routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: LayoutComponent,\r\n        canActivate: [AuthGuardService],\r\n        children: [\r\n            {\r\n                path: '',\r\n                component: NotificationComponent,\r\n                resolve: {\r\n                    data: NotificationService\r\n                }\r\n            },\r\n        ]\r\n    }\r\n];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule],\r\n    providers: [NotificationService]\r\n})\r\n\r\nexport class NotificationRoutingModule {\r\n}\r\n","module.exports = \"<div class=\\\"notification-container\\\">\\r\\n    <h1 class=\\\"title\\\">Thông báo của bạn</h1>\\r\\n    <hr>\\r\\n    <ul class=\\\"dropdown-menu-list list-notify-container\\\" #notifyContentContainer>\\r\\n        <li class=\\\"notify-item\\\" *ngFor=\\\"let item of listItems$ | async\\\" [class.info]=\\\"item.type === 0\\\"\\r\\n            [class.warning]=\\\"item.type === 1\\\"\\r\\n            [class.danger]=\\\"item.type === 2\\\" [class.success]=\\\"item.type === 3\\\" [class.readed]=\\\"item.isRead\\\"\\r\\n            (click)=\\\"updateRead(item)\\\">\\r\\n            <button class=\\\"notification-close\\\" (click)=\\\"closeNotify(item)\\\">\\r\\n                <i class=\\\"fa fa-times\\\"></i>\\r\\n            </button>\\r\\n            <div class=\\\"notify-left\\\">\\r\\n                <a href=\\\"javascript://\\\">\\r\\n                    <!--<nh-image [baseUrl]=\\\"baseUrl\\\" [value]=\\\"item.fromUserImage\\\" [alt]=\\\"item.title\\\" [width]=\\\"40\\\"-->\\r\\n                              <!--[height]=\\\"40\\\"></nh-image>-->\\r\\n                </a>\\r\\n            </div>\\r\\n            <div class=\\\"notify-body\\\">\\r\\n                <p class=\\\"content\\\" *ngIf=\\\"!item.image\\\" [innerHTML]=\\\"item.content\\\"></p>\\r\\n                <div class=\\\"notify-item\\\" *ngIf=\\\"item.image\\\">\\r\\n                    <div class=\\\"notify-body\\\">\\r\\n                        <p class=\\\"content\\\" [innerHTML]=\\\"item.content\\\"></p>\\r\\n                    </div>\\r\\n                    <div class=\\\"notify-right\\\">\\r\\n                        <a href=\\\"javascript://\\\">\\r\\n                            <!--<nh-image [baseUrl]=\\\"baseUrl\\\" [value]=\\\"item.image\\\" [width]=\\\"40\\\" [height]=\\\"40\\\"></nh-image>-->\\r\\n                        </a>\\r\\n                    </div>\\r\\n                </div>\\r\\n                <div class=\\\"times\\\">\\r\\n                    <i class=\\\"fa fa-clock-o\\\"></i>{{item.time}}\\r\\n                </div>\\r\\n            </div>\\r\\n        </li>\\r\\n    </ul>\\r\\n\\r\\n    <ghm-paging [totalRows]=\\\"totalRows\\\" [currentPage]=\\\"currentPage\\\" [pageShow]=\\\"6\\\" (pageClick)=\\\"search($event)\\\"\\r\\n                [isDisabled]=\\\"isSearching\\\" [pageName]=\\\"'thông báo'\\\"></ghm-paging>\\r\\n</div><!-- END: .notification-container -->\\r\\n\"","import { Component, Inject, OnInit } from '@angular/core';\r\nimport { BaseListComponent } from '../../base-list.component';\r\nimport { NotificationService } from './notification.service';\r\nimport { Notifications } from './notifications.viewmodel';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { IAppConfig } from '../../interfaces/iapp-config';\r\nimport { APP_CONFIG } from '../../configs/app.config';\r\nimport { map } from 'rxjs/operators';\r\nimport { ActionResultViewModel } from '../../shareds/view-models/action-result.viewmodel';\r\nimport { SearchResultViewModel } from '../../shareds/view-models/search-result.viewmodel';\r\n\r\n@Component({\r\n    selector: 'app-notification',\r\n    templateUrl: './notification.component.html'\r\n})\r\n\r\nexport class NotificationComponent extends BaseListComponent<Notifications> implements OnInit {\r\n    isRead: boolean;\r\n    baseUrl: string;\r\n\r\n    constructor(@Inject(APP_CONFIG) appConfig: IAppConfig,\r\n                private route: ActivatedRoute,\r\n                private notificationService: NotificationService) {\r\n        super();\r\n        this.baseUrl = appConfig.baseUrl;\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.listItems$ = this.route.data.pipe(map((result: { data: SearchResultViewModel<Notifications> }) => {\r\n            const data = result.data;\r\n            if (data) {\r\n                this.totalRows = data.totalRows;\r\n                return data.items;\r\n            }\r\n        }));\r\n    }\r\n\r\n    updateRead(notification: Notifications) {\r\n        console.log(notification);\r\n        this.notificationService.updateReadStatus(notification.id, true);\r\n    }\r\n\r\n    search(currentPage: number) {\r\n        this.listItems$ = this.notificationService.search(this.isRead, currentPage)\r\n            .pipe(map((result: SearchResultViewModel<Notifications>) => {\r\n                this.totalRows = result.totalRows;\r\n                return result.items;\r\n            }));\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\n\r\nimport { NotificationComponent } from './notification.component';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NotificationRoutingModule } from './notification-routing.module';\r\nimport { GhmPagingModule } from '../../shareds/components/ghm-paging/ghm-paging.module';\r\n\r\n@NgModule({\r\n    imports: [CommonModule, NotificationRoutingModule, GhmPagingModule],\r\n    exports: [],\r\n    declarations: [NotificationComponent],\r\n    providers: [],\r\n})\r\nexport class NotificationModule {\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { ISearchResult } from '../../interfaces/isearch.result';\r\nimport { Notifications } from './notifications.viewmodel';\r\nimport * as _ from 'lodash';\r\nimport * as moment from 'moment';\r\nimport { IResponseResult } from '../../interfaces/iresponse-result';\r\nimport { ActivatedRouteSnapshot, Resolve } from '@angular/router';\r\n\r\n@Injectable()\r\nexport class NotificationService implements Resolve<ISearchResult<Notifications>> {\r\n    url = 'notification/';\r\n\r\n    constructor(private http: HttpClient,\r\n                private toastr: ToastrService) {\r\n    }\r\n\r\n    resolve(route: ActivatedRouteSnapshot, state: Object) {\r\n        const queryParams = route.queryParams;\r\n        const isRead = queryParams.isRead;\r\n        const page = queryParams.page;\r\n        const pageSize = queryParams.pageSize;\r\n        return this.search(isRead, page, pageSize);\r\n    }\r\n\r\n    updateReadStatus(id: number, isRead: boolean) {\r\n        this.http.get(`${this.url}update-read`, {\r\n            params: new HttpParams()\r\n                .set('id', id.toString())\r\n                .set('isRead', isRead.toString())\r\n        }).subscribe((result: IResponseResult) => {\r\n            this.toastr.success(result.message);\r\n        });\r\n    }\r\n\r\n    search(isRead?: boolean, page: number = 1, pageSize: number = 20): Observable<ISearchResult<Notifications>> {\r\n        return this.http.get(`${this.url}search`, {\r\n            params: new HttpParams()\r\n                .set('isRead', isRead !== undefined && isRead != null ? isRead.toString() : '')\r\n                .set('page', page ? page.toString() : '1')\r\n                .set('pageSize', pageSize ? pageSize.toString() : '')\r\n        }).pipe(map((result: ISearchResult<Notifications>) => {\r\n            _.each(result.items, (item: Notifications) => {\r\n                item.time = moment(item.time).fromNow();\r\n            });\r\n            return result;\r\n        })) as Observable<ISearchResult<Notifications>>;\r\n    }\r\n}\r\n"],"sourceRoot":""}