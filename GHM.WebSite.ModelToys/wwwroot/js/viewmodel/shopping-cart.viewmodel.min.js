function ShoppingCartViewModel(){var n=this;n.listProduct=ko.observableArray([]);n.totalPrice=ko.observable(0);n.totalMoney=ko.observable("");n.isSending=ko.observable(!1);n.fullName=ko.observable("");n.email=ko.observable("");n.address=ko.observable("");n.note=ko.observable("");n.phoneNumber=ko.observable("");n.addProductQuantity=function(t,i){i?t.productQuantity(parseInt(t.productQuantity())+1):t.productQuantity()>0&&t.productQuantity(parseInt(t.productQuantity())-1);t.totalPrice(t.productQuantity()*t.salePrice);$.post(`/gio-hang/updateQuantity/${t.id}`,{quantity:t.productQuantity(),__RequestVerificationToken:token},function(){});n.renderTotalPrice()};n.renderTotalPrice=function(){n.totalPrice(_.reduce(n.listProduct(),function(n,t){return n+t.totalPrice()},0));n.totalMoney(ConverMoneyToString(formatNumberic(n.totalPrice(),"N0")))};n.changeQuantity=function(t){t.productQuantity($(`#product-${t.id}`).val());t.totalPrice(t.productQuantity()*t.salePrice);$.post(`/gio-hang/updateQuantity/${t.id}`,{quantity:t.productQuantity(),__RequestVerificationToken:token},function(){});n.renderTotalPrice()};n.removeProduct=function(t){$.post(`/gio-hang/remove/${t.id}`,{__RequestVerificationToken:token},function(i){var r,u,f,e;i&&(r=_.find(n.listProduct(),function(n){return n.id===t.id}),r&&n.listProduct.remove(r),u=document.getElementById("quantity-product"),u.textContent=n.listProduct().length,f=document.getElementById("quantity-product-bottom"),f.textContent=i.length,e=document.getElementById("quantity-product-sidebar"),e.textContent=n.listProduct().length)})};n.order=function(){if($("#formInsertUpdate").valid()){n.isSending(!0);var t=_.map(n.listProduct(),function(n){return{productId:n.id,quantity:n.quantity}});if(!t||t.length===0){toastr.error("Vui lòng chọn sản phẩm");return}$.post("/gio-hang/order",{fullName:n.fullName(),phoneNumber:n.phoneNumber(),email:n.email(),address:n.address(),note:n.note(),listProduct:t,__RequestVerificationToken:token},function(t){var i,r;if(n.isSending(!1),t>0){$("#ordersuccessfulModal").modal("show");n.listProduct([]);i=document.getElementById("quantity-product");i.textContent=n.listProduct().length;r=document.getElementById("quantity-product-sidebar");r.textContent=n.listProduct().length;return}toastr.error(t)})}};$(document).ready(function(){products&&(_.each(products,function(n){n.productQuantity=ko.observable(n.quantity);n.totalPrice=ko.observable(n.product.salePrice*n.productQuantity());n.id=n.product.id;n.name=n.product.name;n.salePrice=n.product.salePrice;n.thumbnail=n.product.thumbnail;n.defaultUnit=n.product.defaultUnit;n.seoLink=n.product.seoLink}),n.listProduct(products),n.renderTotalPrice())})}var viewModel=new ShoppingCartViewModel;ko.applyBindings(viewModel,document.getElementsByClassName("shopping-carts")[0]);