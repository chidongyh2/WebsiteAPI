function ShoppingCartViewModel(){var n=this;n.listProduct=ko.observableArray([]);n.totalPrice=ko.observable(0);n.totalMoney=ko.observable("");n.isSending=ko.observable(!1);n.fullName=ko.observable("");n.email=ko.observable("");n.address=ko.observable("");n.note=ko.observable("");n.phoneNumber=ko.observable("");n.fullNameError=ko.observable("");n.phoneNumberError=ko.observable("");n.emailError=ko.observable("");n.addressError=ko.observable("");n.isFullNameFocus=ko.observable(!1);n.isEmailFocus=ko.observable(!1);n.isAddressFocus=ko.observable(!1);n.isPhoneNumberFocus=ko.observable(!1);n.addProductQuantity=function(t,i){i?t.productQuantity(parseInt(t.productQuantity())+1):t.productQuantity()>0&&t.productQuantity(parseInt(t.productQuantity())-1);t.totalPrice(t.productQuantity()*t.salePrice);$.post(`/gio-hang/updateQuantity/${t.id}`,{quantity:t.productQuantity(),__RequestVerificationToken:token},function(){});n.renderTotalPrice()};n.renderTotalPrice=function(){n.totalPrice(_.reduce(n.listProduct(),function(n,t){return n+t.totalPrice()},0));n.totalMoney(ConverMoneyToString(formatNumberic(n.totalPrice(),"N0")))};n.changeQuantity=function(t){t.productQuantity($(`#product-${t.id}`).val());t.totalPrice(t.productQuantity()*t.salePrice);$.post(`/gio-hang/updateQuantity/${t.id}`,{quantity:t.productQuantity(),__RequestVerificationToken:token},function(){});n.renderTotalPrice()};n.removeProduct=function(t){$.post(`/gio-hang/remove/${t.id}`,{__RequestVerificationToken:token},function(i){var r,u,f,e;i&&(r=_.find(n.listProduct(),function(n){return n.id===t.id}),r&&n.listProduct.remove(r),u=document.getElementById("quantity-product"),u.textContent=n.listProduct().length,f=document.getElementById("quantity-product-bottom"),f.textContent=i.length,e=document.getElementById("quantity-product-sidebar"),e.textContent=n.listProduct().length)})};n.fullName.subscribe(function(t){t&&t!==""&&t.trim()!==""?n.fullNameError(""):n.fullNameError("Vui lòng nhập họ tên của bạn")});n.email.subscribe(function(t){t&&t!==""&&t.trim()!==""?n.emailError(""):n.emailError("Vui lòng email của bạn");t&&t!==""&&!CheckEmailFormat(t)?n.emailError("Định dạng email không đúng"):n.emailError("")});n.phoneNumber.subscribe(function(t){t&&t!==""?n.phoneNumberError(""):n.phoneNumberError("Vui lòng nhập số điện thoại của bạn")});n.address.subscribe(function(t){t&&t!==""?(n.addressError(""),n.isAddressFocus(!1)):(console.log(t),n.addressError("Vui lòng nhập địa chỉ của bạn"),n.isAddressFocus(!0))});n.order=function(){if(!n.fullName()||n.fullName()===""||n.fullName().trim()===""){n.fullNameError("Vui lòng nhập họ tên của bạn");n.isFullNameFocus(!0);return}if(!n.phoneNumber()||n.phoneNumber()===""){n.phoneNumberError("Vui lòng nhập số điện thoại của bạn");n.isPhoneNumberFocus(!0);return}if(!n.email()||n.email()===""){n.emailError("Vui lòng email của bạn");n.isEmailFocus(!0);return}if(n.email()&&n.email()!==""&&!CheckEmailFormat(n.email())){n.emailError("Định dạng email không đúng");n.isEmailFocus(!0);return}if(n.address()&&n.address()!=="")n.addressError(""),n.isAddressFocus(!1);else{n.addressError("Vui lòng nhập địa chỉ của bạn");n.isAddressFocus(!0);return}if(!n.fullNameError()&&!n.emailError()&&!n.phoneNumberError()&&!n.addressError()){n.isSending(!0);var t=_.map(n.listProduct(),function(n){return{productId:n.id,quantity:n.quantity}});if(!t||t.length===0){toastr.error("Vui lòng chọn sản phẩm");return}$.post("/gio-hang/order",{fullName:n.fullName(),phoneNumber:n.phoneNumber(),email:n.email(),address:n.address(),note:n.note(),listProduct:t,__RequestVerificationToken:token},function(t){var i,r;if(console.log(t),n.isSending(!1),t===-1){n.fullNameError("Vui lòng nhập họ tên của bạn");n.isFullNameFocus(!0);return}if(t===-2){n.phoneNumberError("Vui lòng số điện thoại của bạn");n.isPhoneNumberFocus(!0);return}if(t===-3){n.emailError("Vui lòng email của bạn");n.isEmailFocus(!0);return}if(t===-4){n.addressError("Vui lòng nhập địa chỉ của bạn");n.isAddressFocus(!0);return}if(t>0){$("#ordersuccessfulModal").modal("show");n.listProduct([]);i=document.getElementById("quantity-product");i.textContent=n.listProduct().length;r=document.getElementById("quantity-product-sidebar");r.textContent=n.listProduct().length;return}toastr.error(t)})}};$(document).ready(function(){products&&(_.each(products,function(n){n.productQuantity=ko.observable(n.quantity);n.totalPrice=ko.observable(n.product.salePrice*n.productQuantity());n.id=n.product.id;n.name=n.product.name;n.salePrice=n.product.salePrice;n.thumbnail=n.product.thumbnail;n.defaultUnit=n.product.defaultUnit;n.seoLink=n.product.seoLink}),n.listProduct(products),n.renderTotalPrice())})}var viewModel=new ShoppingCartViewModel;ko.applyBindings(viewModel,document.getElementsByClassName("shopping-carts")[0]);