function ProductDetailViewModel(){var n=this;n.productCategoryTree=ko.observableArray([]);n.listProductImage=ko.observableArray([]);n.productThumbnail=ko.observable();n.listCategory=ko.observableArray([]);n.listProductAttribute=ko.observableArray([]);n.listAttributeValue=ko.observableArray([]);n.listAttributeContent=ko.observableArray([]);n.quantity=ko.observable(1);n.totalMoney=ko.observable(0);n.productId=ko.observable(null);n.rendProductCategoryActive=function(){_.each(n.listProductCategory(),function(t,i){t.IsActive(i<=n.lastIndex()&&i>=n.firstIndex())})};n.rendTree=function(t){_.each(t,function(t){t.state.show=ko.observable(t.state.opened);t.children&&t.children.length>0&&n.rendTree(t.children)})};n.selectThumbnail=function(t){if(t){n.productThumbnail(t.url);var r=$(".easyzoom").easyZoom(),i=r.data("easyZoom");i.teardown();i._init()}};n.renderAttribute=function(){var i,r,t;n.listAttributeValue([]);n.listAttributeContent([]);i=_.filter(n.listProductAttribute(),function(n){return!n.isSelfContent});i&&i.length>0&&(r=_.groupBy(i,function(n){return n.attributeId}),_.each(r,function(t){var i=[];_.each(t,function(n){i.push(n)});n.listAttributeValue.push({attributeName:t[0].attributeName,values:_.map(i,"attributeValueName").join(", "),listValue:i})}));t=_.filter(n.listProductAttribute(),function(n){return n.isSelfContent});t&&t.length>0&&_.each(t,function(n){n.isSelected=ko.observable(!1)});n.listAttributeContent(t)};n.totalMoney=ko.computed(function(){return n.quantity()*productInfo.salePrice});n.addShoppingCart=function(t){t?n.quantity(n.quantity()+1):n.quantity()>0&&n.quantity(n.quantity()-1)};n.showTabDetail=function(){_.each(n.listAttributeContent(),function(n){n.isSelected(!1)});$("#comment").removeClass("active");$("#liComment").removeClass("active");$("#detail").addClass("active");$("#liDetail").addClass("active")};n.buy=function(){if(n.quantity()===0){toastr.error("Vui lòng chọn số lượng sản phẩm");$("#productQuantity").focus();return}$.post(`/gio-hang/buy/${n.productId()}`,{quantity:n.quantity()},function(n){var t,i;n&&(toastr.success("Thêm mới sản phẩm vào giỏ hàng thành công."),t=document.getElementById("quantity-product"),t.textContent=n.length,i=document.getElementById("quantity-product-sidebar"),i.textContent=n.length)})};n.selectProductAttribute=function(t){_.each(n.listAttributeContent(),function(n){n.isSelected(!1)});t.isSelected(!0);$("#comment").removeClass("active");$("#liComment").removeClass("active");$("#detail").removeClass("active");$("#liDetail").removeClass("active")};n.showTabComment=function(){_.each(n.listAttributeContent(),function(n){n.isSelected(!1)});$("#comment").addClass("active");$("#liComment").addClass("active");$("#detail").removeClass("active");$("#liDetail").removeClass("active")};$(document).ready(function(){if(Globalize.culture("vi-VN"),n.rendTree(treeData),n.productCategoryTree(treeData),n.listProductImage(productImages),n.listCategory(productCategories),n.listProductAttribute(productAttributes),productInfo&&(n.productThumbnail(productInfo.thumbnail),n.productId(productInfo.id)),$("#product-image-silder").lightSlider({item:4,auto:!1,loop:!0,slideMove:1,speed:1500,pause:3e3,slideMargin:10,pauseOnHover:!1,controls:!0,prevHtml:'<img src="/images/facion/pev.png" />',nextHtml:'<img src="/images/facion/nex.png" />',pager:!1,responsive:[{breakpoint:800,settings:{item:4,slideMove:1}},{breakpoint:480,settings:{item:3,slideMove:1}}]}),$(".easyzoom").easyZoom({errorNotice:"Không tìm thấy ảnh",loadingNotice:"Đang tải ảnh"}),n.renderAttribute(),productSelectItems){var t=_.find(productSelectItems,function(n){return n.product.id===productInfo.id});t&&n.quantity(t.quantity)}})}var viewModel=new ProductDetailViewModel;ko.applyBindings(viewModel,document.getElementsByClassName("product-detail")[0]);