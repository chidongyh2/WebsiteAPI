function ProductCategoryViewModel(){var n=this;n.listProductCategory=ko.observableArray([]);n.productCategoryId=ko.observable();n.productCategorySeoLink=ko.observable();n.listProduct=ko.observableArray([]);n.firstIndex=ko.observable(0);n.lastIndex=ko.observable(window.innerWidth<768?1:3);n.totalRows=ko.observable(0);n.pageSize=ko.observable(6);n.currentPage=ko.observable(1);n.totalPage=ko.observable(1);n.listPage=ko.observableArray([]);n.categoryName=ko.observable();n.categoryDescription=ko.observable();n.categoryImage=ko.observable();n.productCategoryTree=ko.observableArray([]);n.selectProductCategory=function(t){n.productCategoryId(t.Id);n.productCategorySeoLink(t.SeoLink);n.currentPage(1);n.search()};n.search=function(){$.get("/get-productcategory-and-list",{seolink:n.productCategorySeoLink(),page:n.currentPage(),pageSize:n.pageSize()},function(t){n.listProduct(t.items);n.renderPage(t.totalRows);var i=_.find(n.listProductCategory(),function(t){return t.SeoLink===n.productCategorySeoLink()});i&&(n.categoryName(i.Name),n.categoryDescription(i.Description),n.categoryImage(i.Image))})};n.renderPage=function(t){if(n.totalRows(t),n.totalPage(Math.ceil(n.totalRows()/n.pageSize())),n.listPage([]),n.totalPage()>1)for(var i=1;i<=n.totalPage();i++)n.listPage.push({page:i})};n.searchPageIndex=function(t){n.currentPage(t.page);n.search()};n.firstPage=function(){n.currentPage(1);n.search();$("html, body").animate({scrollTop:$("#Products").offset().top-50},1e3)};n.lastPage=function(){n.currentPage(n.totalPage());n.search();$("html, body").animate({scrollTop:$("#Products").offset().top-50},1e3)};n.prevPage=function(){n.currentPage(n.currentPage()-1);n.search();$("html, body").animate({scrollTop:$("#Products").offset().top-50},1e3)};n.nextPage=function(){n.currentPage(n.currentPage()+1);n.search();$("html, body").animate({scrollTop:$("#Products").offset().top-50},1e3)};n.rendProductCategoryActive=function(){_.each(n.listProductCategory(),function(t,i){t.IsActive(i<=n.lastIndex()&&i>=n.firstIndex())})};n.nextIndex=function(){if(n.listProductCategory()&&n.lastIndex()<=n.listProductCategory().length-1){n.firstIndex(n.firstIndex()+1);n.lastIndex(n.lastIndex()+1);n.rendProductCategoryActive();var t=_.findIndex(n.listProductCategory(),function(t){return t.Id===n.productCategoryId()});t<n.firstIndex()&&(n.productCategoryId(n.listProductCategory()[n.firstIndex()].Id),n.selectProductCategory(n.listProductCategory()[n.firstIndex()]))}};n.prevIndex=function(){if(n.listProductCategory()&&n.firstIndex()>0){n.firstIndex(n.firstIndex()-1);n.lastIndex(n.lastIndex()-1);n.rendProductCategoryActive();var t=_.findIndex(n.listProductCategory(),function(t){return t.Id===n.productCategoryId()});t>n.lastIndex()&&(n.productCategoryId(n.listProductCategory()[n.lastIndex()].Id),n.selectProductCategory(n.listProductCategory()[n.lastIndex()]))}};n.showChildren=function(){};n.rendTree=function(t){_.each(t,function(t){t.state.show=ko.observable(t.state.opened);t.children&&t.children.length>0&&n.rendTree(t.children)})};$(document).ready(function(){_.each(productCategories,function(n){n.IsActive=ko.observable(!1)});n.listProductCategory(productCategories);n.productCategoryId(parseInt(productCategoryId));var t=_.findIndex(n.listProductCategory(),function(t){return t.Id===n.productCategoryId()});t>n.lastIndex()&&(n.firstIndex(n.listProductCategory().length-1>t+n.lastIndex()?t:n.listProductCategory().length-(n.lastIndex()+1)),n.lastIndex(n.listProductCategory().length-1>t+n.lastIndex()?t+n.lastIndex():n.listProductCategory().length-1));categoryInfo&&(n.categoryImage(categoryInfo.name),n.categoryDescription(categoryInfo.description),n.categoryImage(categoryInfo.image));n.listProduct(products);n.renderPage(totalRows);n.rendProductCategoryActive();n.rendTree(treeData);n.productCategoryTree(treeData)})}var viewModel=new ProductCategoryViewModel;ko.applyBindings(viewModel,document.getElementsByClassName("product-categories")[0]);