ko.components.register("comment-component",{viewModel:function(n){var t=this;t.objectId=n.objectId?n.objectId:-1;t.objectType=n.objectType?n.objectType:-1;t.listComments=ko.observableArray([]);t.rendTree=function(n){_.each(n,function(n){n.state.show=ko.observable(!1);n.children&&n.children.length>0&&t.rendTree(n.children)})};t.getComment=function(){$.get("/get-comment",{objectId:t.objectId,objectType:t.objectType,page:1,pageSize:20},function(n){t.rendTree(n.items);t.listComments(n.items);console.log(t.listComments())})};$(document).ready(function(){t.getComment()})},template:`<div class="comments">
       <div class="line"></div>
            <h3 class="title">Bình luận</h3>       
            <comment-box-component params="objectId: objectId, objectType: objectType"></comment-box-component>
            <h2 class="comment-no">
               <b data-bind="text: listComments().length"></b>
                Bình luận.           
            </h2>
           <comment-list-component params="objectId: objectId, objectType: objectType, listComments: listComments"></comment-list-component>
       </div>`});ko.components.register("comment-box-component",{viewModel:function(n){var t=this;t.objectId=n.objectId?n.objectId:-1;t.objectType=n.objectType?n.objectType:-1;t.parentId=n.parentId?ko.observable(n.parentId):ko.observable(null);t.userId=n.userId?n.userId:ko.observable(null);t.userType=n.userType?n.userType:ko.observable(0);t.fullName=ko.observable();t.email=ko.observable();t.content=ko.observable();t.isSending=ko.observable(!1);t.save=function(){t.isSending(!0);$.post("/comment",{objectId:t.objectId,objectType:t.objectType,fullName:t.fullName(),email:t.email(),content:t.content(),parentId:t.parentId(),userId:t.userId(),userType:t.userType(),__RequestVerificationToken:token},function(n){if(t.isSending(!1),n>0){t.fullName("");t.email("");t.content("");return}toastr.error(n)})};$(document).ready(function(){})},template:`<div class="box-comment">
       <form id="postComment" class="form-horizontal" data-bind="submit: save">
       <div class="row">
           <div class="col-sm-6">
               <div class="form-group">
                 <input class="form-control" data-bind="value: fullName" placeholder="Họ tên của bạn (bắt buộc)">
                </div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <input class="form-control" data-bind="value: email" placeholder="Email của bạn"> 
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                 <div class="form-group">
                       <textarea class="form-control" data-bind="value: content" spellcheck="false" placeholder="Mời bạn nhập câu hỏi hoặc đánh giá (bắt buộc)."></textarea> 
                 </div>
            </div>
        </div>  
        <div class="row">
             <div class="col-sm-12">
                 <button type="submit" class="btn btn-send" data-bind="enable:!isSending()"> 
                     <i class="fa fa-spin fa-spinner" data-bind="visible:isSending()"style="display:none"></i>
                     Gửi bình luận
                  </button>
              </div>
        </div>      
       </form>       
</div>`});ko.components.register("comment-list-component",{viewModel:function(n){var t=this;t.objectId=n.objectId?n.objectId:-1;t.objectType=n.objectType?n.objectType:-1;t.listComments=n.listComments?n.listComments:ko.observableArray([]);$(document).ready(function(){})},template:`<div class="list-comment" data-bind="foreach: listComments">
    <div class="comment-item">
        <div class="media">
            <div class="media-left">
                <div class="avatar">
                    <img src="/images/no-avartar.jpg" class="img-circle" style="width:100%">
                </div>
                <div class="media-body">
                    <div class="content">
                        <p class="intro">
                            <strong class="name" data-bind="text: data.fullName "></strong>
                            <span data-bind="text: moment(data.createTime, 'DD/MM/YYYY').fromNow()"></span>
                        </p>
                        <div class="comment-details" data-bind="text: data.content ">
                        </div>
                        <p class="tools">
                            <a href="javascript:;" class="showComment" data-bind="click: function(data){ data.state.show(!data.state.show());}">
                            <span>Trả lời</span> <i class="fa fa-comments"></i> </a>                   
                        </p>
                         <!--ko if: state.show()-->                        
                         <comment-box-component params="objectId: $parent.objectId, objectType: $parent.objectType, parentId: id"></comment-box-component>
                         <!--/ko-->
                         <!--ko if: childCount > 0-->
                               <div class="children">
                               <comment-list-component params="objectId: $parent.objectId, objectType: $parent.objectType, listComments: children"></comment-list-component> 
                               </div>
                         <!--/ko-->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>`});